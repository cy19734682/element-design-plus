import{d as q,u as F,e as n,f as J,o as O,g as M,q as N,h as r,w as c,l as u,i as o,z as U,D as z,B as G,F as K,G as Z,H as _,I as A,$ as T,J as H,K as Q,_ as W}from"./index-0b6b4772.js";import{e as X,a as Y,b as ee}from"./export2Zip-4c5398fc.js";const ae={class:"app-container"},te={class:"app-search-table"},le=q({name:"emRowPageEx",__name:"emRowPageEx",setup(oe){const f=F();let d=n({}),y=n({}),p=n([]),w=n([{type:"input",key:"name",placeholder:"名称"},{type:"input",placeholder:"类型",key:"mimeType"},{type:"select",placeholder:"后缀",key:"extension",options:[{label:"jpg",val:".jpg"},{label:"html",val:".html"},{label:"png",val:".png"},{label:"jpeg",val:".jpeg"}]}]);const g=n([{key:"id",label:"ID",render:a=>{var e;return H(Q,{style:{width:"100%",height:"200px"},src:((e=window==null?void 0:window._global)==null?void 0:e.serverImg)+a.row.imgPath})}},{key:"name",label:"名称"}]),C=n([{type:"input",label:"名称",key:"name"},{type:"input",label:"类型",key:"mimeType"},{type:"select",label:"后缀",key:"extension",options:[{label:"jpg",val:".jpg"},{label:"html",val:".html"},{label:"png",val:".png"},{label:"jpeg",val:".jpeg"}]}]),D=n({name:{required:!0},mimeType:{required:!0},extension:{required:!0}}),x=n(),i=n(),m=n(),E=a=>{y.value=K(a)},R=a=>{console.log(a)},$=a=>{console.log(a),p.value=a.map(e=>e.id)},j=()=>{x.value.changeLoading(!1)},B=()=>{i.value.open()},L=a=>{let e="";if(Z(a))e=a;else{if(p.value.length<=0){_.warning("请选择数据");return}e=p.value.join()}A.confirm("是否确认删除","提示").then(()=>{T.delete(f.serverUrl+"/bt-table",{ids:e}).then(()=>{_.success("删除成功"),m.value.getTableData()}).catch()}).catch(l=>{console.log(l)})},k=()=>{setTimeout(()=>{i.value.resetForm(),d.value={}},200)},P=a=>{let e="post";d.value.id&&(e="put",a.id=d.value.id),T[e](f.serverUrl+"/bt-table",a,{isShowLoading:!0}).then(()=>{_.success(e==="post"?"新增成功":"编辑成功"),m.value.getTableData(),i.value.changeLoading(!1),i.value.close(),k()}).catch(l=>{i.value.changeLoading(!1)})},S=()=>{const a=m.value.dataT||[];let e=g.value.filter(t=>t.key),l=e.map(t=>t.label),s=e.map(t=>t.key),b=a.map(t=>s.map(h=>t[h]));X({header:l,data:b,filename:"表格数据"})},V=()=>{const a=m.value.dataT||[];let e=g.value.filter(t=>t.key),l=e.map(t=>t.label),s=e.map(t=>t.key),b=a.map(t=>s.map(h=>t[h])),v="表格数据";Y(l,b,v,v)},I=()=>{ee("tablePage",1,4,"表格数据")};return(a,e)=>{const l=J("el-button");return O(),M("div",ae,[N("div",te,[r(o(U),{ref_key:"searchFormRef",ref:x,"form-data":o(w),btnLoading:"",onOnSearch:E},{beginBtnGroup:c(()=>[r(l,{type:"success",onClick:e[0]||(e[0]=s=>B())},{default:c(()=>[u(" 新增")]),_:1}),r(l,{type:"danger",disabled:!(o(p)&&o(p).length>0),onClick:e[1]||(e[1]=s=>L())},{default:c(()=>[u(" 删除 ")]),_:1},8,["disabled"]),r(l,{type:"primary",onClick:e[2]||(e[2]=s=>I())},{default:c(()=>[u(" TABLE导出")]),_:1}),r(l,{type:"warning",onClick:e[3]||(e[3]=s=>S())},{default:c(()=>[u(" JSON导出")]),_:1}),r(l,{type:"warning",onClick:e[4]||(e[4]=s=>V())},{default:c(()=>[u(" zip导出")]),_:1})]),_:1},8,["form-data"]),r(o(z),{id:"tablePage",ref_key:"tableRef",ref:m,radio:"",url:o(f).serverUrl+"/bt-table-page",isTable:!1,"row-gutter":15,columns:o(g),searchData:o(y),orderKey:"",onRowClick:R,onSelectionChange:$,onOnDataChange:j},null,8,["url","columns","searchData"])]),r(o(G),{ref_key:"formModalRef",ref:i,title:o(d).id?"编辑":"新增","form-data":o(C),"form-rules":o(D),btnLoading:"",onOnSubmit:P,onOnClose:k},null,8,["title","form-data","form-rules"])])}}});const re=W(le,[["__scopeId","data-v-66b8fba2"]]);export{re as default};
